<div class="single">
  <!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="generator" content="Hugo 0.15" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <link rel='stylesheet' href='http://fonts.useso.com/css?family=Open+Sans|Marcellus+SC'>
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="/css/tomorrow-night-eighties.css">
    <link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="/css/custom.css">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="http://simonpatrick.github.io//index.xml">

    
    <title>Python完成简单的SVN Reviewboard Precommit的客户端 - Colored Hedwig</title>
    <meta property='og:title' content="Python完成简单的SVN Reviewboard Precommit的客户端 - Colored Hedwig">
    <meta property="og:type" content="article">
    

    <meta property="og:url" content="http://simonpatrick.github.io/posts/python/2015-05-16-svn_reviewboard_python/">
    
    <meta property="og:image" content="http://simonpatrick.github.io/images/map[feature:&lt;nil&gt;]">

  </head>

  <body>

    <header class="site">
      <div class="title"><a href="http://simonpatrick.github.io/">Colored Hedwig</a></div>
    </header>

    <div class="container site">


  <div class="row">
    <div class="col-sm-9">

      <article class="single" itemscope="itemscope" itemtype="http://schema.org/Article">

        <meta itemprop="mainEntityOfPage"  itemType="https://schema.org/WebPage" content="http://simonpatrick.github.io/"/>
        <meta itemprop="dateModified" content="2015-05-16T10:31:11&#43;08:00">
        <meta itemprop="headline" content="Python完成简单的SVN Reviewboard Precommit的客户端">
        <meta itemprop="description" content="最近公司需要使用review board进行代码pre-commit review(pre-commit:正式提交前review)，而公司的现状是： 1. 使用SVN作为代码版本管理工具 2. 开发工具有eclipse，idea 3. MAC 和windows 机器居多 考虑到开发eclipse和idea插件，连接review board我一个人无法完成，同时能力也不够来开发这两种插件， 所以就准备python写一个命令行工具，期间研究了一下taobao review board的插件，感觉有点复杂，这个也是 使用python来些命令行工具的一个理由,也考虑过使用node-webkit来写个客户端，不过由于时间上的限制也就先放弃了 实现 实现过程中，使用到主要的包和工具是： RBTools,review board 自带的工具，但是支持中文能力让人有点困惑 python，cmd 包(python自带)，requests包使用 pip install requests 安装 ConEmuPack(windows CMD的替代),主要为了支持window系统 SVN 最后实现了如下功能 - 选择更改的文件，提交Review Board 作为pre-commit review - 根据review request id 提交代码到SVN - python直接操作svn命令,可以通过简单的命令就提交代码(由于使用习惯的问题,个人觉得命令行比UI效率更高) svn命令有个问题就是如果操作delete或者add这种的话,如果文件没有直接放到svn work copy的话,提交需要两步操作, 而这个工具也解决了这个问题 Review Board 功能介绍 review board 是进行代码review的一个工具，目前公司主要用来做pre-commit的review，在review board针对pre-主要有如下概念： review request draft, draft里面包含了differ文件，描述，review的人等等 review request，在这个review request上面review review完毕，才可以提交代码 安装和配置 1.安装Python 和Requests包 下载安装最新版本的Python，确保在命令行中可以执行Python命令，如果打开命令行工具，执行python -v 失败，需要在环境变量中设置Python的执行路径 安装Python完成之后，在命令行中执行 pip install requests 安装requests包到全局。MAC可能需要使用: sudo pip install requests 2.">
        <meta itemprop="url" content="http://simonpatrick.github.io/posts/python/2015-05-16-svn_reviewboard_python/">
        <div itemprop="image" itemscope itemtype="https://schema.org/ImageObject">
          <meta itemprop="url" content="http://simonpatrick.github.io/images/map[feature:&lt;nil&gt;]" />
          <meta itemprop="width" content="800">
          <meta itemprop="height" content="800">
        </div>
        <div itemprop="publisher" itemscope itemtype="https://schema.org/Organization">
          <div itemprop="logo" itemscope itemtype="https://schema.org/ImageObject">
            <meta itemprop="url" content="http://simonpatrick.github.io/images/logo.jpg">
            <meta itemprop="width" content="100">
            <meta itemprop="height" content="100">
          </div>
          <meta itemprop="name" content="Colored Hedwig">
        </div>
        <div itemprop="author" itemscope itemtype="https://schema.org/Person">
          <meta itemprop="name" content="">
        </div>

        <div class="image" style="background-image: url(http://simonpatrick.github.io/images/map[feature:%3cnil%3e]);"></div>

        <header class="article-header">
          <time itemprop="datePublished" pubdate="pubdate" datetime="2015-05-16T10:31:11&#43;08:00">Sat, May 16, 2015</time>
          <h1 class="article-title">Python完成简单的SVN Reviewboard Precommit的客户端</h1>
        </header>

        <div class="article-body" itemprop="articleBody">
          

<p>最近公司需要使用review board进行代码pre-commit review(pre-commit:正式提交前review)，而公司的现状是：
1. 使用SVN作为代码版本管理工具
2. 开发工具有eclipse，idea
3. MAC 和windows 机器居多</p>

<p>考虑到开发eclipse和idea插件，连接review board我一个人无法完成，同时能力也不够来开发这两种插件，
所以就准备python写一个命令行工具，期间研究了一下taobao review board的插件，感觉有点复杂，这个也是
使用python来些命令行工具的一个理由,也考虑过使用node-webkit来写个客户端，不过由于时间上的限制也就先放弃了</p>

<h2 id="实现:9c8e3f625c3962072302f48860331be5">实现</h2>

<p>实现过程中，使用到主要的包和工具是：</p>

<ol>
<li>RBTools,review board 自带的工具，但是支持中文能力让人有点困惑</li>
<li>python，cmd 包(python自带)，requests包使用 pip install requests 安装</li>
<li>ConEmuPack(windows CMD的替代),主要为了支持window系统</li>
<li>SVN</li>
</ol>

<p>最后实现了如下功能
- 选择更改的文件，提交Review Board 作为pre-commit review
- 根据review request id 提交代码到SVN
- python直接操作svn命令,可以通过简单的命令就提交代码(由于使用习惯的问题,个人觉得命令行比UI效率更高)
  svn命令有个问题就是如果操作delete或者add这种的话,如果文件没有直接放到svn work copy的话,提交需要两步操作,
  而这个工具也解决了这个问题</p>

<h2 id="review-board-功能介绍:9c8e3f625c3962072302f48860331be5">Review Board 功能介绍</h2>

<p>review board 是进行代码review的一个工具，目前公司主要用来做pre-commit的review，在review board针对pre-主要有如下概念：</p>

<ul>
<li>review request draft, draft里面包含了differ文件，描述，review的人等等</li>
<li>review request，在这个review request上面review</li>
<li>review完毕，才可以提交代码</li>
</ul>

<h2 id="安装和配置:9c8e3f625c3962072302f48860331be5">安装和配置</h2>

<h3 id="1-安装python-和requests包:9c8e3f625c3962072302f48860331be5">1.安装Python 和Requests包</h3>

<ul>
<li>下载安装最新版本的Python，确保在命令行中可以执行Python命令，如果打开命令行工具，执行python -v 失败，需要在环境变量中设置Python的执行路径</li>
<li>安装Python完成之后，在命令行中执行</li>
</ul>

<pre><code class="language-sh">pip install requests
</code></pre>

<p>安装requests包到全局。MAC可能需要使用:</p>

<pre><code class="language-sh">sudo pip install requests
</code></pre>

<h3 id="2-安装rbtools:9c8e3f625c3962072302f48860331be5">2. 安装RBTools</h3>

<p>下载安装RBTool,RBTool有不同操作系统对应的版本，根据自身操作系统下载并安装，MAC和windows都是可执行文件，一路next就可以
安装完毕，在命令行检查是否安装成功:</p>

<pre><code class="language-sh"> rbt -v
</code></pre>

<p>检查版本，如果有版本显示则成功</p>

<h3 id="3-配置svn:9c8e3f625c3962072302f48860331be5">3. 配置SVN</h3>

<p>配置SVN，MAC自带了SVN，Windows需要将SVN，配置到环境变量里面，具体方法如下,命令行中执行</p>

<pre><code class="language-sh">	svn --version
</code></pre>

<p>如果返回版本信息，则忽略下面步骤:</p>

<pre><code>下载SVN BIN文件，将BIN目录配置到环境变量PATH下面，命令行中执行svn --version如果返回版本信息则成功
</code></pre>

<h3 id="4-windows-下载comemupack:9c8e3f625c3962072302f48860331be5">4. Windows 下载ComEmuPack</h3>

<p>ComEmuPack是Windows Cmd的替代工具，主要为了解决中文输入和显示问题，Window上使用，如果MAC上使用终端工具就可以terminal或者iterm都可以</p>

<h2 id="运行客户端:9c8e3f625c3962072302f48860331be5">运行客户端</h2>

<p>复制svnrbclient.py 到你本地SVN的目录下面，这个目录需要和Review Board上面的配置相对应，具体如下例说明：
1.review board配置某个repository是<a href="https://scm.******.com:8443/svn/Test/automation">https://scm.******.com:8443/svn/Test/automation</a>
2.repository的名字是：******-automation,假设你使用</p>

<pre><code class="language-sh">svn checkout https://scm.******.com:8443/svn/******-automation
</code></pre>

<p>检出代码到***<strong><em>-automation目录，那么你需要将svnrbclient.py复制到你本地的</em></strong>***-automation下面.</p>

<p>打开命令行工具，运行</p>

<pre><code class="language-sh">python svnrbclient.py
</code></pre>

<p>就可以，第一次使用会让你配置你的review board设置，如果嫌麻烦，可以创建如下内容的文件
到.reviewboardrc，不过复制之前需要修改，具体修改参考一下注释.</p>

<pre><code>// 不需要修改
REVIEWBOARD_URL = &quot;192.168.3.180&quot;
// 一般修改至你动作的目录名
REPOSITORY = &quot;******-automation&quot;
// 工号
USERNAME=110863
//review board密码，和LDAP密码一样
PASSWORD=&quot;*******&quot;
// 默认代码审查人的工号，可以是****，****格式，,间隔表示多人
TARGET_PEOPLE=****
</code></pre>

<h2 id="使用客户端:9c8e3f625c3962072302f48860331be5">使用客户端</h2>

<p>在运行客户端之后，可以看到如下内容：</p>

<pre><code class="language-sh">        ****** Review Board Client, ? for help, and the total command lists:
        1. setup:setup review board setting
        2. pre:precommit your changes to review board
        3. upre:update your precommit
        4. ss:svn status,find svn status for the working copies
        5. sa:svn add,add files to local svn
        6. sd:svn delete,delete svn file
        7. ci:svn commit,commit the changes by review request id
        8. sre: revert changes
        9. sdiff: generate differ file
        10.sci: commit the selected files directly
        11.exit: exit the client
       (****** RB Client)
</code></pre>

<p>以上就是这个客户端的所有功能，重点是如下几个功能：
1. pre: 创建review request
2. upre： 更新review request
3. ci: review通过之后，提交代码到SVN中央仓库，这个是根据review request id来作的提交
  也就是你提交review request修改了什么文件，使用ci命令就帮你提交此review request修改过的文件
一般执行方法是：在(****** RB Client)后面输入你需要的命令如：pre,然后按照提示一步一步操作就可以了.以下是输入的日志：</p>

<p>以下是使用pre commit的一个完全的shell场景:</p>

<ul>
<li>输入命令pre</li>
</ul>

<pre><code>****** RB Client)pre
// 得到输出，需要选择此次修改的文件：
pre-commit the changes
svn status:
Changed Files Status:
ID |FILE SVN Status|File Name/File Path
0 | ? | .git
1 | ? | .idea
2 | ? | .ignorerc
3 | A | .reviewboardrc
4 | ? | automation-common/automation-common.iml
5 | M | automation-common/src/main/java/com/******/automation/ITestProcessor.java
6 | ? | automation-common/target
7 | A | automation-demo/automation-demo.iml
8 | ? | automation-demo/target
9 | A | differ_temp
10 | A | differ_temp/105
11 | A | differ_temp/105/diff_105_latest.txt
12 | A | differ_temp/105/differ_1432611692.92.txt
13 | A | differ_temp/105/differ_1432612400.93.txt
14 | A | differ_temp/105/notes.txt
15 | A | differ_temp/113
16 | A | differ_temp/113/diff_113_latest.txt
17 | A | differ_temp/113/differ_1432620381.6.txt
18 | A | differ_temp/113/differ_1432620573.37.txt
19 | A | differ_temp/113/notes.txt
20 | A | differ_temp/114
21 | A | differ_temp/114/diff_114_latest.txt
22 | A | differ_temp/114/differ_1432621517.49.txt
23 | A | differ_temp/114/differ_1432621894.64.txt
24 | ? | differ_temp/114/differ_1432622051.84.txt
25 | A | differ_temp/114/notes.txt
26 | ? | differ_temp/115
27 | ? | differ_temp/116
28 | ? | differ_temp/125
29 | ? | differ_temp/132
30 | ? | ******-automation.iml
31 | A | rbtools_requests.py
32 | M | svnrbtclient.py
33 | A | +
34 |  | &gt;
35 | Summary | of
36 |  | Tree
</code></pre>

<ul>
<li>输入文件的ID， 可以是5,32，或者是5-32，34-90 表示5-32,34-90的文件</li>
</ul>

<pre><code>Please select the files IDs which your want to commit,eg. 0,1,2,3, or Enter for All Files
&lt;5,32


automation-common/src/main/java/com/******/automation/ITestProcessor.java svnrbtclient.py is ready to post to review board......
Please input your reviewer ID,Entry for default Reviewer&gt;
reviewer ID:
Please input summary for your changes,it is nice to provide your Bug No:&gt;修改svnrbclient
&lt;Response [201]&gt;
None
update draft timeout but it doesn't matter
draft request review id :133

//到这里review request 提交完毕
</code></pre>

<ul>
<li>审核通过之后，输入ci命令，提交review request</li>
</ul>

<pre><code>(****** RB Client)ci

last 5 review requests status:
Request Review Id |Summary  | Status | Changed File List
133 | 修改svnrbclient
 | pending | automation-common/src/main/java/com/******/automation/ITestProcessor.java svnrbtclient.py

132 | 测试很多文件
 | pending | README.md automation-common/src/main/java/com/******/automation/Environment.java automation-common/src/main/java/com/******/automation/ITestProcessor.java automation-common/src/main/java/com/******/automation/drivers/DriverFactory.java automation-common/src/main/java/com/******/automation/helpers/webdriver/WebDriverHelper.java automation-common/src/main/java/com/******/automation/listener/testng/SimpleWebDriverScreenShotTestListener.java automation-common/src/main/java/com/******/automation/testscaffold/BaseWebCurrencyTest.java automation-common/src/main/java/com/******/automation/testscaffold/BaseWebTest.java automation-common/src/main/java/com/******/automation/testscaffold/webtest/WebTestContext.java automation-common/src/main/java/com/******/automation/testscaffold/webtest/webUI/elementloader/locator/CustomerElementLocatorFactory.java automation-common/src/main/java/com/******/automation/testscaffold/webtest/webUI/htmlelements/HtmlElement.java automation-common/src/test/java/com/******/automation/drivers/DriverFactoryTest2.java automation-common/src/test/java/com/******/automation/drivers/DriverFactoryTest_Concurrency.java automation-common/src/test/java/com/******/automation/drivers/testng-test1.xml automation-common/src/test/java/com/******/automation/helpers/webdriver/WebDriverHelperTest.java

115 | 更新readme
 | pending | ******rbclient_en.py README.md

116 | 测试测试
 | pending | ******rbclient.py

125 | 修改中文注释
 | pending | automation-common/src/main/java/com/******/automation/Environment.java automation-common/src/main/java/com/******/automation/ITestProcessor.java

//输入你要需要提交的 review request id号：  //提交结束
(****** RB Client)

</code></pre>

        </div>


        <aside>
          <div class="section">
            <a href="http://simonpatrick.github.io/tags/python" class="tag">python</a>
            </div>

          <div class="section share">
            
            
            
            
          </div>

          
          
          
        </aside>

      </article>
    </div>

    <div class="col-sm-3">
      <aside class="site">

  
  <div class="section">
    <header><div class="title">TableOfContents</div></header>
    <div class="list-default"><nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#实现:9c8e3f625c3962072302f48860331be5">实现</a></li>
<li><a href="#review-board-功能介绍:9c8e3f625c3962072302f48860331be5">Review Board 功能介绍</a></li>
<li><a href="#安装和配置:9c8e3f625c3962072302f48860331be5">安装和配置</a>
<ul>
<li><a href="#1-安装python-和requests包:9c8e3f625c3962072302f48860331be5">1.安装Python 和Requests包</a></li>
<li><a href="#2-安装rbtools:9c8e3f625c3962072302f48860331be5">2. 安装RBTools</a></li>
<li><a href="#3-配置svn:9c8e3f625c3962072302f48860331be5">3. 配置SVN</a></li>
<li><a href="#4-windows-下载comemupack:9c8e3f625c3962072302f48860331be5">4. Windows 下载ComEmuPack</a></li>
</ul></li>
<li><a href="#运行客户端:9c8e3f625c3962072302f48860331be5">运行客户端</a></li>
<li><a href="#使用客户端:9c8e3f625c3962072302f48860331be5">使用客户端</a></li>
</ul></li>
</ul>
</nav></div>
  </div>
  

  

  <div class="section">
    <header><div class="title">LatestPosts</div></header>
    <div class="content">
      
      <div class="sm"><article class="li">
  <a href="http://simonpatrick.github.io/posts/python/2016-02-28-python_oop_attributes/" class="clearfix">
    <div class="image" style="background-image: url(http://simonpatrick.github.io/images/default.jpg);"></div>
    <div class="detail">
      <time>Sun, Feb 28, 2016</time>
      <h2 class="title">Python 面向对象，以及访问对象属性基础</h2>
      <div class="summary">在前面的Zabbix API调用中我们看到了python的__getattr__的妙用，下面就探索一下这里面的道理,所以就聊聊python面向对象的基础知识. Python 面向对象 说到面向对象，就会说到类(class)，对象(object),那么什么是Class，Object呢？ Object： Objects have states and behaviors. Example: A dog has states - color, name, breed as well as behaviors -wagging, barking, eating. An object is an instance of a class. Class: A class can be defined as a template/blue print that describes the behaviors/states that object of its type support. 那么综合起来，class就是用来描述一系列对象的一个模版，抽象出了共同的东西(class)，object就是具体的某种情况下的一个例子(instance) 面向对象有如下基础概念： Polymorphism Inheritance Encapsulation Abstraction Classes Objects Instance Method Message Parsing Python Class and Object 的使用 看下例： - class Dog 定义了一个类 - __init__ 构造这个类的方法，就是创建出一个Dog的对象是通过这个方法 - name, 类的一个属性;eat(),也可以看成是类的一个属性，实际上它是一个dog的一个行为(behavior) - dog = Dog() 是创建了一个Dog(class)的新的的对象(object), 按照我们上面说的，dog是类Dog(class)的一个实例(instance) class Dog: def __init__(self): self.name='dog' def eat(): print('eating......') dog = Dog() print(dog.name) Python 对象的创建 参考上例，分别来说明对象的创建，访问.</div>
    </div>
  </a>
</article>
</div>
      
      <div class="sm"><article class="li">
  <a href="http://simonpatrick.github.io/posts/python/2016-02-28-simple_word_count/" class="clearfix">
    <div class="image" style="background-image: url(http://simonpatrick.github.io/images/default.jpg);"></div>
    <div class="detail">
      <time>Sun, Feb 28, 2016</time>
      <h2 class="title">Simple Word Counter</h2>
      <div class="summary">有时测试的面试题中会考点编程的内容，比如统计字符串中的相同字符数量，具体题目如下： 给定一个字符串，如MIssissippi 计算字符串中每一个不同字符出现的数量 Python 的解法 letter_count={} for letter in 'MIssissippi': letter[letter]=letter_count.get(letter,0)+1 print(letter_count) 运行结果： {'s': 4, 'M': 1, 'i': 3, 'I': 1, 'p': 2} Java 的解法 JAVA 8 中给Map加入了getOrDefault的方法，下面就分别介绍一下JAVA8之前和使用JAVA8的方法： JAVA8 之前： public Map&lt;String,Integer&gt; countCharacters(String source){ char[] chars = source.toCharArray(); Map&lt;String,Integer&gt; result = new HashMap&lt;&gt;(); for (char aChar : chars) { Integer existing_counter = result.get(String.valueOf(aChar)); int counter = existing_counter==null?0:existing_counter; result.put(String.valueOf(aChar),counter+1); } return result; } JAVA8 解法 public Map&lt;String,Integer&gt; countCharacters_JAVA8(String source){ char[] chars</div>
    </div>
  </a>
</article>
</div>
      
      <div class="sm"><article class="li">
  <a href="http://simonpatrick.github.io/posts/python/2016-02-26-call_zabbix_api/" class="clearfix">
    <div class="image" style="background-image: url(http://simonpatrick.github.io/images/default.jpg);"></div>
    <div class="detail">
      <time>Fri, Feb 26, 2016</time>
      <h2 class="title">Python 访问Zabbix API</h2>
      <div class="summary">Zabbix API 访问 准备使用Python来访问一下Zabbix，首先当然阅读一下Zabbix的API Manual,抛开什么json rpc这样的问题之外，zabbix的API的分类还是很工整的，所以看起来比较舒服，在一定了解了zabbix基础之后，基本上就可以上手来写了，网上查了一下，找个一个python zabbix的调用的一个客户段代码，感觉不错，就开始行动了。 Zabbix API 客户端代码的实现 Zabbix API的主要的两个参数其实是method，params，params基本上就可以看作一些可变的参数，其实就是一个json或者map， 对于method来说，一般就是 resource.action 这种方式，所以python客户端使用重写了一个getattr来做,返回一个可以访问不同资源名称的客户端,具体的代码如下： class ZabbixClient: &quot;&quot;&quot; Generic Zabbix API Client - login - get auth &quot;&quot;&quot; globale_header = { &quot;Content-Type&quot;: &quot;application/json-rpc&quot; } def __init__(self, session=None, timeout=None): self.user_name, self.default_user_name = '1', '1' self.password, self.default_password = '123456', '123456' self.zabbix_api_url = 'http://{0}/api_jsonrpc.php'.format('abcd.http') if session: self.session = session else: self.session = requests.session() self.session.headers.update({ 'Content-Type': 'application/json-rpc', 'User-Agent': 'python-zabbix-client', 'Cache-Control': 'no-cache' }) self.auth = '' self.id = 0 self.timeout = timeout logger.info('JSON-RPC Server EndPoint: %s', self.zabbix_api_url) def login_in(self, user_name=None, password=None): &quot;&quot;&quot; login with given user_name and password, if None, use default user :param user_name: :param password: :return: result,auth key &quot;&quot;&quot; if user_name: self.user_name = user_name if password: self.password = password self.auth = self.user.login(user=self.user_name, password=self.password) def api_version(self): return self.apiinfo.version() # def confimport(self, format='', source='', rules=''): # &quot;&quot;&quot;Alias for configuration.import because it clashes with # Python's import reserved keyword&quot;&quot;&quot; # # return self.do_request( # method=&quot;configuration.import&quot;, # params={&quot;format&quot;: format, &quot;source&quot;: source, &quot;rules&quot;: rules} # )['result'] def do_request(self, method, params=None): request_json = { 'jsonrpc': '2.0', 'method': method, 'params': params or {}, 'id': self.id, } if method != 'apiinfo.version' and self.auth: request_json['auth'] = self.auth logger.debug(&quot;sending: %s&quot;, json.dumps(request_json, indent=4, separators=(',', ':'))) response = self.session.post( self.zabbix_api_url, data=json.dumps(request_json), timeout=self.timeout ) logger.debug(&quot;Response Code : %s&quot;, str(response.status_code)) response.raise_for_status() if not len(response.text): raise ZabbixAPIException(&quot;没有返回值&quot;) try: response_json = json.loads(response.text) except ValueError: raise ZabbixAPIException(&quot;不能解析JSON %s&quot; % response.text) logger.debug(&quot;sending: %s&quot;, json.dumps(request_json, indent=4, separators=(',', ':'))) self.id += 1 if 'error' in response_json: if 'data' not in response_json['error']: response_json['error']['data'] = 'No Data' msg = &quot;Error {code}: {message},{data}&quot;.format( code=response_json['error']['code'], message=response_json['error']['message'], data=response_json['error']['data'] ) raise ZabbixAPIException(msg, response_json['error']['code']) return response_json def __getattr__(self, item): &quot;&quot;&quot; auto create Zabbix API Client :param item: :return: &quot;&quot;&quot; return ZabbixAPIObjectClass(item, self) class ZabbixAPIObjectClass(object): def __init__(self, name, parent): self.name = name self.parent = parent def __getattr__(self, item): &quot;&quot;&quot; dynamic create a method (get,create,update,delete) :param item: :return: &quot;&quot;&quot; def fn(*args, **kwargs): if args and kwargs: raise TypeError('Found Both args and kwargs') return self.parent.do_request('{0}.{1}'.format(self.name, item), args or kwargs)['result'] return fn 基本上一个文件就搞定了，不过这个基本上参考了网上的一个代码实现的，这里使用getattr这种方式可以非常简洁的处理了这种请求非常类似的情况，这也是python的魅力吧.</div>
    </div>
  </a>
</article>
</div>
      
      <div class="sm"><article class="li">
  <a href="http://simonpatrick.github.io/posts/python/2016-02-26-zabbix_monitoring/" class="clearfix">
    <div class="image" style="background-image: url(http://simonpatrick.github.io/images/default.jpg);"></div>
    <div class="detail">
      <time>Fri, Feb 26, 2016</time>
      <h2 class="title">zabbix 基础</h2>
      <div class="summary">抽空花了1个小时看了一下Zabbix的界面和简单的手册，了解了一下Zabbix的基础知识，下面是一个小小的记录,后面就写一些Python的脚本来直接调用Zabbix的API在进行一些自动化的操作. Zabbix 基础 Zabbix 是一个开源的监控系统，由于需要帮助运维写一些调用ZABBIX API的代码，所以就开始了解一下ZABBIX的一些基本概念. 简单的看了一下Zabbix的一个手册，大致了解Zabbix监控的一些概念，以下是Zabbix中比较重要的概念或者可以认为一些抽象的实体资源: Configuration HOST HOST GROUP Templates Monitor Application Items: keys Triggers Graphs Configuration:HOST HOST 就是Zabbix监控的对象，创建HOST可以通过一些预先定义好的模版来实现. 以Linux Group来说的话，HOST可能还有以下的一些属性： Agent Interface SNMP Interface JMX Interface IPMI Interface Monitory proxy Status Configuration: HOST GROUP 创建HOST的同时可以创建一个HOST GROUP，HOST GROUP实际上就是不同的HOST组合起来成一组. Configuration: Templates Templates 就是一些HOST的模版，相似的HOST可以通过模版继承，组合的方式创建 Monitor 从监控的层级来看，监控HOST的层级逻辑是： HOSTGROUP: HOST GROUP是可以认为不同HOST的容器 HOST: 监控的实体,监控的实体实际上有不同的监控模版组合而成 以下的APPLICATION，ITEM,TRIGGER,Graph 其实都是继承了模版的： APPLICATION,可以认为是一组监控的内容 ITEM: item就是监控的具体的一个数值,比如cl Loaded Class Count他的key是jmx[&quot;java.lang:type=ClassLoading&quot;,LoadedClassCount] 这个ITEM就是具体监控LoadedClass数目的一项，那么多个项目就可以组合成一个Application，ITEM 其实可以认为是采样数据的一个项 一个Template可以通过多个Application来组合而成，一个Application可以由Items来组合而成，一个HOST包含有多个监控的Template，一个HOST Group可以有多个HOST. 关于TEMPLATE的继承关系是： HOST 继承HOST GROUP的TEMPLATE Graph： 图表 Trigger： 触发器 这两个可以设置到模版级别的 Monitor: Application Application 可以认为是监控的一个大的项目，里面可能包括了不同的采样项目(item) create Application，可以参考一下API文档就可以 Monitor: Item Item创建首先需要创建一个key(在创建KEY之前可以先创建一个TEMPLATE)，key 相当于需要监控什么，如何设置？ - 监控客户端设置, 在zabbix_agentd.conf中需要添加UserParameter grep -v '#' /etc/zabbix/zabbix_agentd.conf|grep -v &quot;^$&quot; export UserParameter=&lt;key_name&gt;,&lt;shell_command&gt; &gt;&gt; &lt;configure_file_location&gt; ITEM的设置，可以设置ITEM的类型，同时使用一些表达是来完成需要的采样内容的设置 Graphs graph 就是图标，那么很明显，一个graph有x,y 轴，x轴一般总是时间序列，另外一个轴对应不同的item（采样项目），同时又一些graph的类型选择，以及图表大小的设置 Triggers Trigger 就是一个触发器，对于单独的一个item来说，如果设置了一些阀值,那么如果超过这个阀值，那么就会报警了.</div>
    </div>
  </a>
</article>
</div>
      
      <div class="sm"><article class="li">
  <a href="http://simonpatrick.github.io/posts/performance/2016-02-22-mobile_perf_testing/" class="clearfix">
    <div class="image" style="background-image: url(http://simonpatrick.github.io/images/default.jpg);"></div>
    <div class="detail">
      <time>Mon, Feb 22, 2016</time>
      <h2 class="title">Mobile 性能测试关键点</h2>
      <div class="summary">移动端性能测试的一些关键点 阅读了一些人的PPT，再这里记录一些移动端性能测试的一些关键点，每个关键点会在后续润色，细化. 移动端性能测试的方方面面 Android Monkey Memory Usage: /system/build.prop dalvik.vm.heapstartsize=8m # 堆分配的初始大小 dalvik.vm.heapgrowthlimit=64m adb shell procrank DDMS adb shell top 启动性能(首次，多次) 流量 应用占用量，cachesize，datasize，codesize 电量 CPU: active, idel memory leak, hprof, ddms dump hprof GPU 过度绘制 1.蓝色1x过度绘制 2.绿色2x过度绘制 3.淡红色3x过度绘制 4.红色超过4x过度绘制 gfxinfo systrace traceview tracer for OpenGL ES IOS instruments api business flow/scenario Performance Baseline comparison 颗粒度 Business flow Automation supporting poor network condition Security 混淆 加固 权限 本地数据库安全 ContentProvider共享 Activity注入风险 Tools Fiddler</div>
    </div>
  </a>
</article>
</div>
      
      <div class="sm"><article class="li">
  <a href="http://simonpatrick.github.io/posts/performance/2016-02-22-jmeter_distribution_testing/" class="clearfix">
    <div class="image" style="background-image: url(http://simonpatrick.github.io/images/default.jpg);"></div>
    <div class="detail">
      <time>Mon, Feb 22, 2016</time>
      <h2 class="title">JMETER 分布式测试</h2>
      <div class="summary">JMETER DISTRIBUTION TESTING JMETER有时进行压力测试时，生成压力的机器性能不够，不能产生足够的压力，不过JMETER可以使用多个系统进行JMETER的压力测试，来解决这个问题. 使用多系统测试时需要注意： 关闭防火墙 client in the same subnet 服务器在同一个字网 Jmeter可以访问服务器 JMeter是同一版本的 JMETER Distribution Setting Master Setup config remote address: jmeter.properties: remote_host=ip1,ip2,ip3&hellip;.. salve setup running jmeter-server.bat/.sh 文件 modify jmeter-server file to change the rmiregistry location start TESTING Additional Resources JMETER FAQ REMOTE-TEST</div>
    </div>
  </a>
</article>
</div>
      
      <div class="sm"><article class="li">
  <a href="http://simonpatrick.github.io/posts/python/2016-02-13-python-yaml/" class="clearfix">
    <div class="image" style="background-image: url(http://simonpatrick.github.io/images/default.jpg);"></div>
    <div class="detail">
      <time>Sat, Feb 13, 2016</time>
      <h2 class="title">python yaml 使用介绍</h2>
      <div class="summary">Python YAML 应用 YAML由于其可读性，越来越多的地方用它来做配置文件了来代替XML文件.下面就是用来介绍如何使用PYTHON来进行YAML的操作. 读取yaml或者写yaml，主要是用的是两个方法： load 读 dump 写 Read YAML to List 以下是读YAML 内容到python的list import yaml def load_list(): content = &quot;&quot;&quot; - config - domain - repository &quot;&quot;&quot; return yaml.load(content) Read YAML TO DICT load yaml to dict or a nest dict: import yaml def load_dict(): content = &quot;&quot;&quot; hello1: test hello2: test2 &quot;&quot;&quot; return yaml.load(content) def load_all_dict(): contents = &quot;&quot;&quot; hero: hp: 34 sp: 8 level: 4 orc: hp: 12 sp: 0 level: 2 &quot;&quot;&quot; return yaml.load(contents) print(load_dict()) print(load_all_dict()) Read YAML: auto type conversation yaml 对于格式要求比较严格的，： 后面注意加空格，同时python的原始类型通过load函数可以自动转化的.</div>
    </div>
  </a>
</article>
</div>
      
      <div class="sm"><article class="li">
  <a href="http://simonpatrick.github.io/posts/microservice/2016-02-01-microservice-try/" class="clearfix">
    <div class="image" style="background-image: url(http://simonpatrick.github.io/images/default.jpg);"></div>
    <div class="detail">
      <time>Mon, Feb 1, 2016</time>
      <h2 class="title">01-微服务框架－Springboot/Flask,Hello World</h2>
      <div class="summary">现在有很多的微服务框架，这里试用一下Java Springboot和Python的Flask. 本文分别试用SpringBoot和Flask完成了一个简单的Hello World服务来展示如何使用Springboot和Flask构建 一个简单的服务. 同时用AB进行了一个简单的压力测试。 SpringBoot Hello World Web Application Create a SpringBoot Application entry point add Beans into springboot startup life cycle 利用command-line runner的这个特性，再配合依赖注入，可以在应用程序启动时后首先引入一些依赖bean，例如data source、rpc服务或者其他模块等等，这些对象的初始化可以放在run方法中。不过，需要注意的是，在run方法中执行初始化动作的时候一旦遇到任何异常，都会使得应用程序停止运行，因此最好利用try/catch语句处理可能遇到的异常。 create HelloWorld Service All Codes for the simple hello world Service 以下代码的一些说明： - Web 应用的执行入口： main方法，里面的SpringApplication.run - StartupRunner 可以在SpringBoot Application启动过程中一些事情 - RestController注解表示了这个类是个Rest 风格的Controller pom.xml 中的唯一依赖，请指定版本或者parent指定为 &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;/dependencies&gt; @SpringBootApplication @RestController public class HelloWorldEndPoint { public static void main(String[] args) { SpringApplication.run(HelloWorldEndPoint.class,args); } public static class StartupRunner implements CommandLineRunner{ protected final Logger logger = LoggerFactory.getLogger(StartupRunner.class); @Override public void run(String...</div>
    </div>
  </a>
</article>
</div>
      
      <div class="sm"><article class="li">
  <a href="http://simonpatrick.github.io/posts/automation/2016-02-01-assertions/" class="clearfix">
    <div class="image" style="background-image: url(http://simonpatrick.github.io/images/default.jpg);"></div>
    <div class="detail">
      <time>Mon, Feb 1, 2016</time>
      <h2 class="title">assertions</h2>
      <div class="summary">由于一直都在进行测试的工作，所以会关注Assertion的工具，发现两个不错的Assertion 第三方包，准备在实践中使用. 这两个分别是： - Google Truth(http://google.github.io/truth/usage/) - assertj 这个里面有很多自己想实现的比较的功能。一下是一些简单的试用的代码。 Google Truth 基础的验证： @Test public void test_basic_truth(){ Set&lt;String&gt; foo = Sets.newHashSet(); assertThat(foo).isEmpty(); assertThat(foo).isNotNull(); assertThat(5).isEqualTo(5L); assertThat(5L).isEqualTo(5); assert_().that(50).isEqualTo(50); assertThat(&quot;test&quot;).isEqualTo(&quot;test&quot;); assertThat(&quot;test&quot;).contains(&quot;te&quot;); } Collections/Maps的验证: @Test public void test_basic_truth_maps_collections(){ Set&lt;String&gt; foo = Sets.newHashSet(); assertThat(foo).isEmpty(); assertThat(foo).isNotNull(); foo.add(&quot;test&quot;); foo.add(&quot;test1&quot;); foo.add(&quot;test2&quot;); assertThat(foo).contains(&quot;test&quot;); assertThat(foo).containsAllOf(&quot;test&quot;, &quot;test1&quot;); assertThat(foo).containsExactly(&quot;test2&quot;, &quot;test&quot;, &quot;test1&quot;); assertThat(foo).containsNoneOf(&quot;test889&quot;, &quot;test10&quot;); Map&lt;String,String&gt; maps = Maps.newHashMap(); maps.put(&quot;test&quot;, &quot;test1&quot;); maps.put(&quot;test1&quot;, &quot;test2&quot;); maps.put(&quot;test2&quot;, &quot;test3&quot;); assertThat(maps).containsKey(&quot;test1&quot;); assertThat(maps).containsEntry(&quot;test1&quot;, &quot;test2&quot;); assertThat(maps).doesNotContainEntry(&quot;test0&quot;, &quot;test0&quot;); } assertj 基础的验证： @Test public</div>
    </div>
  </a>
</article>
</div>
      
      <div class="sm"><article class="li">
  <a href="http://simonpatrick.github.io/posts/automation/2016-01-27-web-dev/" class="clearfix">
    <div class="image" style="background-image: url(http://simonpatrick.github.io/images/default.jpg);"></div>
    <div class="detail">
      <time>Wed, Jan 27, 2016</time>
      <h2 class="title">WEB 开发的几个重点</h2>
      <div class="summary">再试用了Web 开发的框架之后，归纳一下大致的一个基础Web 开发需要的那些元素: URL Router，如何定义URL的访问 Request Handler/Response Handler， HTTP请求/返回的处理 如果组织这些Request Handler/Response Handler 如何定义全局/局部的URL拦截器 如何处理特殊的HTTP Header 如何处理Session/Cookie Database Access Layer/ORM， 数据操作CRUD 如何CRUD 如何进行分页，排序，filterByCriteria&hellip;..等数据库的常见操作 如何管理事务 如何定义，初始化数据库表 如何组织不同的数据库操作成不同的业务动作 详细，复杂的ORM操作可以不用太在意 Template Render,模版渲染 不同模版的试用 静态资源的访问 单元测试 断言，EXCEPTION检查 Mock 数据，内存数据库的使用 Web Application部署 不同环境的配置管理 不同语言的打包工具，如MAVEN，GRADLE 不同的构建工具,GULP 不同的服务器，NGINX，TOMCAT，JBOSS</div>
    </div>
  </a>
</article>
</div>
      
    </div>
  </div>

  
  <div class="section taxonomies">
    <header><div class="title">category</div></header>
    <div class="content">
      <a href="http://simonpatrick.github.io/categories/python">python</a><a href="http://simonpatrick.github.io/categories/refactoring">refactoring</a><a href="http://simonpatrick.github.io/categories/automation">automation</a><a href="http://simonpatrick.github.io/categories/shell">shell</a><a href="http://simonpatrick.github.io/categories/testing">testing</a><a href="http://simonpatrick.github.io/categories/thoughts">thoughts</a><a href="http://simonpatrick.github.io/categories/microservice">microservice</a><a href="http://simonpatrick.github.io/categories/designpattern">designpattern</a><a href="http://simonpatrick.github.io/categories/truestories">truestories</a><a href="http://simonpatrick.github.io/categories/java">java</a>
    </div>
  </div>
  
  <div class="section taxonomies">
    <header><div class="title">tag</div></header>
    <div class="content">
      <a href="http://simonpatrick.github.io/tags/python">python</a><a href="http://simonpatrick.github.io/tags/refactoring">refactoring</a><a href="http://simonpatrick.github.io/tags/automation">automation</a><a href="http://simonpatrick.github.io/tags/shell">shell</a><a href="http://simonpatrick.github.io/tags/testing">testing</a><a href="http://simonpatrick.github.io/tags/thoughts">thoughts</a><a href="http://simonpatrick.github.io/tags/microservice">microservice</a><a href="http://simonpatrick.github.io/tags/designpattern">designpattern</a><a href="http://simonpatrick.github.io/tags/java">java</a><a href="http://simonpatrick.github.io/tags/truestories">truestories</a>
    </div>
  </div>
  

</aside>

    </div>

  </div>

      </div>

    <footer class="site">
      <p>&copy; 2016 Colored Hedwig</p>
      <p>Powered by <a href="http://gohugo.io" target="_blank">Hugo</a>,</p>
      <p>Theme <a href="https://github.com/dim0627/hugo_theme_robust" target="_blank">Robust</a> designed by <a href="http://yet.unresolved.xyz" target="_blank">Daisuke Tsuji</a></p>
    </footer>

    <script src="//code.jquery.com/jquery-2.1.3.min.js"></script>
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    

  </body>
</html>

</div>
