# 性能测试

## 性能测试步骤
- 分析测试需求
- 制定测试方案
- 执行测试
- 分析测试结果

一般性能测试分为以上一个步骤，以下就以登陆/打卡这个场景来分析。

## 性能测试引子
公司有一个打卡的系统，由于这段时间新员工增加了40%左右，登陆，打卡一般几种在一个时间点内，某天
总监说我们登陆有点慢，每个请求的响应时间不够快呀。所以需要性能测试一下看看哪里问题。
一般性能测试很有可能是如此引发的。那么遇到这样的需求需要如何来作呢？

接了任务吗，就像模像样的把任务细化，分解一下，这样有了一个模式以后也好做；不管简单的任务，复杂的任务，对于工作来说或许找到一个可复制的模式会更有效；在某个模式下，在进行分析，整理，寻找更好的解决方案等等，这些都可以在后续的工作中逐一完善；建立一个模式，一个解决问题框架，可以让你更清晰的看到那些需要改变，那些需要改善，那些可以保持，那些做的很好。

处于这样的考虑，还是决定记录一下这次任务的解决过程，同时希望对性能测试也有更深入的了解。

### 测试前的几个问题

测试前，对于JMeter还算熟悉，所以登陆脚本马上就搞定了，不过由于回去生产环境上面压，所以还需要一些用户的密码，对此这个问题，经过简单的讨论，可以使用不正确的密码；但是对于这一点，稍微有点保留意见，因为不确定内部的实现，所以姑且介绍这点，看还没有的测试结果吧。

其他还有一个问题就是，Jmeter的压力在哪里做？由于整个压力要求不高，所以自己本地机器应该可以够用，但是经过讨论，需要使用机房的机器压，我也有一些疑问，到底怎么样的情况才符合实际情况呢？

针对以上的问题，我个人觉得我需要理解以下几点：

- 登陆业务所涉及到的网络结构是怎么样的
- 登陆业务所涉及到的服务器，AD服务器，数据库的架构是怎么样的

### 测试前的分析

- 应用架构分析

在还是不太了解的登陆业务架构的情况下(也没有太多人愿意多和我讲)的情况下，我先大概推测，同时分析了一下可能的结构（后面会和运维，平台组确认以及了解更多细节），
所以目前还不确认是否又异步处理，或者一眼就能看出来的单点问题

```
应用服务器 登陆API-》 AD 服务器 校验 -》 数据库 记录
```

- 用户使用情况分析

目前使用登陆打卡业务的情况大致如下：
1. 9：00 前后的30分钟，应该是用户使用的高峰期
2. 用户总数大概10000人不到，算10000人
3. 8：45 -9：00 开始应该是用户使用对多的时候，假设这段时间内会有6000人登陆，打开
4. 8：45-9：30 应该同时在线的人数在10000人左右

根据以上的情况，大概估算如下的情况：
1. 高峰期每分钟，平均有400人登陆， 每秒：400/60= 7个
2. 高峰期最高数据就是，每分钟6000，每秒：100个请求
3. 高峰期安装正态分布，每分钟高的值，可能是？个左右(这个计算还不知道，需要了解)，暂时算他3000个，每秒500个

以上是大概用户的使用情况。

### 测试方案

- 不设同步点
  * RampUp 30s
  * 线程组 50，100，200，300，400，500， 每个2分钟
- 设置同步点
  * Rampup 30s
  * 线程组 50，100，200，300，400，500， 每个2分钟
 
需要监控的数据：
1. TPS
2. 90% response
3. 错误率
4. 资源使用情况

对于监控数据，需要寻找一个解决方案，可以将数据写到某处，以后可以使用程序直接把他图表化
同时在实施过程中，根据每个响应时间，决定是否调整测试方案

### 对于这次任务的其他企图
- 了解如何自动生成Jmeter JMX文件
- 如何自动Jmeter生成测试报告

### 测试结果分析

- Jmeter测试结果分析
- 资源使用分析


